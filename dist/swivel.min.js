/**
 * SwivelJS v2.1.1 - 2022-07-24
 * Strategy driven, segmented feature toggles
 *
 * Copyright (c) 2022 Zumba&reg;
 * Licensed MIT
 */
!function(o){"use strict";Array.prototype.reduce||Object.defineProperty(Array.prototype,"reduce",{value:function(t){if(null===this||this===o)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var e,n=Object(this),i=n.length>>>0,r=0;if(2===arguments.length)e=arguments[1];else{for(;r<i&&!(r in n);)r++;if(i<=r)throw new TypeError("Reduce of empty array with no initial value");e=n[r++]}for(;r<i;r++)r in n&&(e=t(e,n[r],r,n));return e}});function n(t,e){this.slug=t,this.strategy=e}function e(t,e){this.slug=t,this.bucket=e,this.waived=!1,w.call(this)}function t(t,e){var n,i,r=e.map;for(n in r)r.hasOwnProperty(n)&&(i=r[n],t[n]=t[n]?t[n]|i:i);return t}function a(t,e){var n,i={};for(n in t)t.hasOwnProperty(n)&&e[n]===o&&(i[n]=t[n]);return i}function i(t,e){var n,i=e.map;for(n in i)i.hasOwnProperty(n)&&(t[n]=i[n]);return t}function r(t){if(!(this instanceof r))return new r(t);var e=(t=t||{}).map||{},n=t.callback||function(){},e=e instanceof x?e:new x(e);this.bucket=new v(e,t.bucketIndex,n)}var u,s,f,l,h=".",c=Array.prototype.reduce,p=Object.prototype.toString,d=function(t){return"[object Array]"===p.call(t)},v=(n.prototype.execute=function(t){return this.strategy.apply(null,t||[])},function(t,e,n){this.featureMap=t,this.index=e,this.callback="function"==typeof n?n:function(){}}),w=(v.prototype.enabled=function(t){t=t.slug;return this.featureMap.slugExists(t)||this.callback(t),this.featureMap.enabled(t,this.index)},function(t,e){this.behavior=t||null,this.args=e||[]}),y="__swivel_default",b=e.prototype,g=(b.addBehavior=function(t,e,n){t=this.getBehavior(t,e);return this.bucket.enabled(t)&&w.call(this,t,n),this},b.addValue=function(t,e){t=this.getBehavior(t,function(){return e});return this.bucket.enabled(t)&&w.call(this,t),this},b.defaultBehavior=function(t,e){if(this.waived)throw"Defined a default behavior after `noDefault` was called.";return this.behavior||w.call(this,this.getBehavior(t),e),this},b.defaultValue=function(t){if(this.waived)throw"Defined a default value after `noDefault` was called.";return this.behavior||w.call(this,this.getBehavior(function(){return t})),this},b.execute=function(){return(this.behavior||this.getBehavior(function(){return null})).execute(this.args||[])},b.getBehavior=function(t,e){if(e===o&&(e=t,t=y),"function"!=typeof e)throw"Invalid callable passed to Builder.getBehavior().";return t=t?this.slug+h+t:this.slug,new n(t,e)},b.noDefault=function(){var t=this.behavior;if(t&&t.slug===y)throw"Called `noDefault` after a default behavior was defined.";return this.waived=!0,this},function(t,e){return e&&0!==parseInt(e,10)?t|1<<--e:t}),m=function(t){var e,n,i={};for(e in t)t.hasOwnProperty(e)&&(n=t[e],i[e]=d(n)?n.reduce(g,0):n);return i},x=function(t){this.map=m(t)},b=x.prototype,b=(b.add=function(){return new x(c.call(arguments,t,this.map))},b.diff=function(t){var e,n=this.map,i=t.map,r=Object.assign(a(i,n),a(n,i));for(e in i)!i.hasOwnProperty(e)||n[e]!==o&&n[e]===i[e]||(r[e]=i[e]);return new x(r)},b.enabled=function(t,e){var n=this.map,i="",r=t.split(h),o=r.length,a=0;for(e=1<<e-1;a<o;a++){u=r[a],i+=i?h+u:u;var u=!this.slugExists(i),s=u||!(parseInt(n[i],10)&e);if(u||s)return!1}return!0},b.slugExists=function(t){return void 0!==this.map[t]},b.intersect=function(t){var e,n=this.map,i=t.map,r={};for(e in i)i.hasOwnProperty(e)&&n[e]===i[e]&&(r[e]=i[e]);return new x(r)},b.merge=function(){return new x(c.call(arguments,i,this.map))},r.prototype),b=(b.forFeature=function(t){return new e(t,this.bucket)},b.invoke=function(t,e,n){t=t.split(h);return this.forFeature(t.shift()).addBehavior(t.join(h),e).defaultBehavior(n).execute()},b.returnValue=function(t,e,n){t=t.split(h);return this.forFeature(t.shift()).addValue(t.join(h),e).defaultValue(n).execute()},b.setBucket=function(t){return this.bucket=t,this},r.Behavior=n,r.Bucket=v,r.Builder=e,r.FeatureMap=x,{function:!0,object:!0});u=b[typeof window]&&window||this,s=b[typeof exports]&&exports&&!exports.nodeType&&exports,f=b[typeof module]&&module&&!module.nodeType&&module,l=f&&f.exports===s&&s,!(b=b[typeof global]&&global)||b.global!==b&&b.window!==b||(u=b),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(u.Swivel=r,define("Swivel",function(){return r})):s&&f?l?(f.exports=r).Swivel=r:s.Swivel=r:u.Swivel=r}.call(this);
//# sourceMappingURL=swivel.min.js.map